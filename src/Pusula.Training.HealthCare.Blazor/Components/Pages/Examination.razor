@page "/examination/{protocolId:guid}/{patientId:guid}"
@using Pusula.Training.HealthCare.Patients
@using Pusula.Training.HealthCare.Anamneses
@using Pusula.Training.HealthCare.PshychologicalStates
@using Syncfusion.Blazor.Cards
@using Syncfusion.Blazor.DataForm
@using Syncfusion.Blazor.Inputs
@using Syncfusion.Blazor.Calendars
@using Syncfusion.Blazor.Navigations
@inject IPatientsAppService PatientsAppService
@inject IAnamnesisAppService AnamnesisAppService
<p>Protocol ID: @ProtocolId Patient ID: @PatientId</p>


@* <SfCard CssClass="e-card e-card-horizontal">
    <div class="e-card-header">
        <div class="e-card-header-image">
            <img src="https://via.placeholder.com/50" alt="Patient" />
        </div>
        <div class="e-card-header-text">
            <h4>@($"{Patient.FirstName} {Patient.LastName}")</h4>
            <p>
                <strong>Yaş:</strong> @(DateTime.Now.Year - Patient.BirthDate.Year) |
                <strong>Doğum Tarihi:</strong> @Patient.BirthDate.ToString("dd.MM.yyyy")
            </p>
        </div>
    </div>
    <div class="e-card-content">
        <p><strong>Hasta No:</strong> @Patient.No | <strong>Ülke:</strong> TR</p>
        <p><strong>Bölüm:</strong> Genel Cerrahi</p>
        <p><strong>Doktor:</strong> Uzm. Dr. Ahmet Hulusi Arslan</p>
    </div>
</SfCard> *@

#<!-- #region patient card -->

<SfCard CssClass="e-card e-card-horizontal">
    <div class="e-card-header">
        <div class="e-card-header-image">
            <img src="https://via.placeholder.com/50" alt="Patient" />
        </div>
        <div class="e-card-header-text">
            <h4>@($"{Patient.FirstName} {Patient.LastName}")</h4>
            <p>
                <strong>Yaş:</strong> @CalculateAge(Patient.BirthDate) |
                <strong>Doğum Tarihi:</strong> @Patient.BirthDate.ToString("dd.MM.yyyy")
            </p>
        </div>
    </div>
    <div class="e-card-content">
        <p><strong>Hasta No:</strong> @Patient.No | <strong>Ülke:</strong> TR</p>
        <p><strong>Bölüm:</strong> Genel Cerrahi</p>
        <p><strong>Doktor:</strong> Uzm. Dr. Ahmet Hulusi Arslan</p>
    </div>
</SfCard>

<!-- #endregion -->

@* <!--  ANAMNESIS  START-->
<SfCard CssClass="e-shadow" Style="width: 48%; float: left; margin-right: 2%;">
    <Syncfusion.Blazor.Cards.CardHeader>
        <strong>Yakınması</strong>
    </Syncfusion.Blazor.Cards.CardHeader>
    <CardContent>
        <!-- Sikayeti-->
        <div class="mb-3">
          
            <SfTextBox @bind-Value="anamnesisCreateDto.Complaint" Placeholder="Şikayeti" CssClass="form-control" />
        </div>

        <!-- Başlangıç Tarihi -->
        <div class="mb-3">
            <p class="form-label">Başlangıç Tarihi</p>
            <div class="d-flex align-items-center">
              
                <SfNumericTextBox TValue="int" @bind-Value="durationValue" Placeholder="0" ShowSpinButton="false" /> 
              

                <!-- Buton Grubu -->
                <div class="btn-group me-2" role="group">
                    <SfButton CssClass="@GetButtonClass("Saat")" @onclick='() => UpdateUnit("Saat")'>Saat</SfButton>
                    <SfButton CssClass="@GetButtonClass("Gün")" @onclick='() => UpdateUnit("Gün")'>Gün</SfButton>
                    <SfButton CssClass="@GetButtonClass("Hafta")" @onclick='() => UpdateUnit("Hafta")'>Hafta</SfButton>
                    <SfButton CssClass="@GetButtonClass("Ay")" @onclick='() => UpdateUnit("Ay")'>Ay</SfButton>
                    <SfButton CssClass="@GetButtonClass("Yıl")" @onclick='() => UpdateUnit("Yıl")'>Yıl</SfButton>
                </div>

                <!-- "Önce" Yazısı -->
                <span class="me-2">Önce</span>

                <!-- DatePicker -->
                <SfDatePicker TValue="DateTime" @bind-Value="selectedDate" Placeholder="Tarih Seç" />
            </div>
        </div>

        <div class="mb-3">
            <SfTextBox @bind-Value="anamnesisCreateDto.Story" Placeholder="Öykü" CssClass="form-control" />
        </div>
    </CardContent>
</SfCard>

<!-- ANAMNESIS END -->

<!-- Psychological State  START-->
<SfCard CssClass="e-shadow" Style="width: 48%; float: left; margin-right: 2%;">
    <Syncfusion.Blazor.Cards.CardHeader>
        <strong>Psikolojik Durum</strong>
    </Syncfusion.Blazor.Cards.CardHeader>
    <CardContent>
        <!-- Psikolojik Durum Buton Grubu -->
        <div class="d-flex align-items-center mb-3">
            <div class="btn-group me-3" role="group">
                @foreach (var state in Enum.GetValues(typeof(MentalState)))
                {
                    <SfButton CssClass="@GetButtonClass((MentalState)state)"
                              @onclick="() => SetMentalState((MentalState)state)">
                        @state
                    </SfButton>
                }
            </div>

            <!-- Açıklama -->
            <SfTextBox @bind-Value="description" Placeholder="Açıklama" CssClass="form-control" Style="width: 100px;" />
        </div>
    </CardContent>
</SfCard>
<!-- Psychological State END --> *@

<!-- ANAMNESIS START -->
<div class="card-container" style="width: 48%; margin-bottom: 2%;">
    <SfCard CssClass="e-shadow">
        <Syncfusion.Blazor.Cards.CardHeader>
            <strong>Yakınması</strong>
        </Syncfusion.Blazor.Cards.CardHeader>
        <CardContent>
            <!-- Şikayeti -->
            <div class="mb-3">
                <SfTextBox @bind-Value="anamnesisCreateDto.Complaint" Placeholder="Şikayeti" CssClass="form-control" />
            </div>

            <!-- Başlangıç Tarihi -->
            <div class="mb-3">
                <p class="form-label">Başlangıç Tarihi</p>
                <div class="d-flex align-items-center">
                    <!-- NumericTextBox -->
                    <SfNumericTextBox TValue="int" @bind-Value="durationValue" Placeholder="0" ShowSpinButton="false" />

                    <!-- Buton Grubu -->
                    <div class="btn-group me-2" role="group">
                        <SfButton CssClass="@GetButtonClass("Saat")" @onclick='() => UpdateUnit("Saat")'>Saat</SfButton>
                        <SfButton CssClass="@GetButtonClass("Gün")" @onclick='() => UpdateUnit("Gün")'>Gün</SfButton>
                        <SfButton CssClass="@GetButtonClass("Hafta")" @onclick='() => UpdateUnit("Hafta")'>Hafta</SfButton>
                        <SfButton CssClass="@GetButtonClass("Ay")" @onclick='() => UpdateUnit("Ay")'>Ay</SfButton>
                        <SfButton CssClass="@GetButtonClass("Yıl")" @onclick='() => UpdateUnit("Yıl")'>Yıl</SfButton>
                    </div>

                    <!-- "Önce" Yazısı -->
                    <span class="me-2">Önce</span>

                    <!-- DatePicker -->
                    <SfDatePicker TValue="DateTime" @bind-Value="selectedDate" Placeholder="Tarih Seç" />
                </div>
            </div>

            <div class="mb-3">
                <SfTextBox @bind-Value="anamnesisCreateDto.Story" Placeholder="Öykü" CssClass="form-control" />
            </div>
        </CardContent>
    </SfCard>
</div>
<!-- ANAMNESIS END -->
<!-- Psychological State START -->
<div class="card-container" style="width: 48%; margin-bottom: 2%;">
    <SfCard CssClass="e-shadow">
        <Syncfusion.Blazor.Cards.CardHeader>
            <strong>Psikolojik Durum</strong>
        </Syncfusion.Blazor.Cards.CardHeader>
        <CardContent>
            <!-- Psikolojik Durum Buton Grubu -->
            <div class="d-flex align-items-center mb-3">
                <div class="btn-group me-3" role="group">
                    @foreach (var state in Enum.GetValues(typeof(MentalState)))
                    {
                        <SfButton CssClass="@GetButtonClass((MentalState)state)"
                                  @onclick="() => SetMentalState((MentalState)state)">
                            @state
                        </SfButton>
                    }
                </div>

                <!-- Açıklama -->
                <SfTextBox @bind-Value="description" Placeholder="Açıklama" CssClass="form-control" Style="width: 100px;" />
            </div>
        </CardContent>
    </SfCard>
</div>
<!-- Psychological State END -->



<style>
    .e-card {
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 15px;
        background-color: #f9f9f9;
        margin-bottom: 20px;
        width: 100%; /* Sayfanın genişliğine uyum sağlar */
    }

    .e-card-header {
        display: flex;
        align-items: center;
    }

    .e-card-header-image img {
        border-radius: 50%;
        width: 50px;
        height: 50px;
        margin-right: 15px;
    }

    .e-card-header-text h4 {
        margin: 0;
        font-size: 18px;
    }

    .e-card-content {
        margin-top: 10px;
    }

</style>