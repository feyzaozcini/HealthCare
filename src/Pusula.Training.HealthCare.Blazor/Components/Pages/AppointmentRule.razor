@page "/appointmentRule"

@using Pusula.Training.HealthCare.Shared
@using Syncfusion.Blazor
@using Syncfusion.Blazor.Inputs
@using Syncfusion.Blazor.DropDowns
@using Syncfusion.Blazor.Buttons
@using Pusula.Training.HealthCare.Departments
@using Pusula.Training.HealthCare.Doctors
@using Pusula.Training.HealthCare.AppointmentRules

@inject IDepartmentsAppService DepartmentsAppService
@inject IDoctorsAppService DoctorsAppService
@inject IAppointmentRulesAppService AppointmentRulesAppService

<div class="row mb-2">
    <div class="col text-end">
        <button class="btn btn-success" @onclick="OpenAddNewDialog">+ Add Appointment Rule</button>
    </div>
</div>
<div class="col-lg-12 control-section">
    <div class="content-wrapper">
        <SfGrid DataSource="@AppointmentRules" AllowPaging="true" Toolbar="@(new List<string>() { "Search" })" OnToolbarClick="OnToolbarClick">
            <GridColumns>
                <GridColumn Field="DepartmentName" HeaderText="Department" Width="150"></GridColumn>
                <GridColumn Field="DoctorFullName" HeaderText="Doctor" Width="150"></GridColumn>
                <GridColumn Field="PatientGender" HeaderText="Gender" Width="100"></GridColumn>
                <GridColumn Field="MinAge" HeaderText="MinAge" Width="50"></GridColumn>
                <GridColumn Field="MaxAge" HeaderText="MaxAge" Width="50"></GridColumn>
                <GridColumn Field="Description" HeaderText="Description" Width="200"></GridColumn>
            </GridColumns>
        </SfGrid>
    </div>
</div>

<SfDialog IsModal="true" Width="600px" Header="Add New Appointment Rule" Visible="@IsAddNewDialogOpen" ShowCloseIcon="true">
    <DialogTemplates>
        <Content>
            <!-- Departman Seçimi -->
            <div>
                <SfDropDownList TValue="Guid"
                                TItem="DepartmentDto"
                                Placeholder="Departman seçiniz..."
                                DataSource="@FilteredDepartments"
                                CssClass="custom-dropdown">
                    <DropDownListFieldSettings Value="Id" Text="Name"></DropDownListFieldSettings>
                    <DropDownListEvents TValue="Guid" TItem="DepartmentDto" ValueChange="OnDepartmentValueChange"></DropDownListEvents>
                </SfDropDownList>
            </div>
            <!-- Doktor Seçimi -->
            <div class ="mt-2">
                <SfDropDownList DataSource="@FilteredDoctors"
                                Placeholder="Doktor seçiniz..."
                                TItem="DoctorWithNavigationPropertiesDto"
                                TValue="Guid">
                    <DropDownListFieldSettings Value="Doctor.Id" Text="FullName"></DropDownListFieldSettings>
                    <DropDownListEvents TValue="Guid" TItem="DoctorWithNavigationPropertiesDto" ValueChange="OnDoctorValueChange"></DropDownListEvents>
                </SfDropDownList>
            </div>
            <div class="mt-2">
                <SfNumericTextBox TValue="int?"
                                  Placeholder="MinAge"
                                  @bind-Value="@NewAppointmentRule.MinAge">
                </SfNumericTextBox>
            </div>
            <div class="mt-2">
                <SfNumericTextBox TValue="int?"
                                  Placeholder="MaxAge"
                                  @bind-Value="@NewAppointmentRule.MaxAge">
                </SfNumericTextBox>
            </div>
            <div class="mt-2">
                <SfDropDownList DataSource="@GendersCollection"
                                Placeholder="Gender"
                                @bind-Value="@NewAppointmentRule.Gender">
                    <DropDownListFieldSettings Value="Id" Text="DisplayName"></DropDownListFieldSettings>
                </SfDropDownList>
            </div>
            <div class="mt-2">
                <SfTextArea Placeholder="Description"
                            @bind-Value="@NewAppointmentRule.Description">
                </SfTextArea>
            </div>
        </Content>
        <FooterTemplate>
            <button class="btn btn-primary" @onclick="CreateAppointmentRule">Save</button>
            <button class="btn btn-secondary" @onclick="() => IsAddNewDialogOpen = false">Cancel</button>
        </FooterTemplate>
    </DialogTemplates>
</SfDialog>


<style>
    .custom-dropdown .e-dropdownbase,
    .custom-dropdown .e-input,
    .custom-dropdown .e-ddl.e-input {
        border-radius: 10px !important; /* Köşeleri yuvarlamak için */
        border: 1px solid #d1d5db; /* Yumuşak bir çerçeve */
        padding: 5px;
    }

        .custom-dropdown .e-dropdownbase:hover,
        .custom-dropdown .e-input:hover {
            border-color: #a3bffa; /* Hover durumunda çerçeve rengi */
            box-shadow: 0px 0px 6px #a3bffa; /* Hafif bir gölge efekti */
        }
</style>
