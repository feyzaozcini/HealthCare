@page "/test-results-report"
@using Pusula.Training.HealthCare.TestProcesses
@using Syncfusion.Licensing

@inject ITestProcessesAppService TestProcessesAppService

<div class="d-flex align-items-center justify-content-between mb-2">
    <div class="d-flex justify-content-center flex-grow-1">
        <SfTextBox Placeholder="Ara"
                   FloatLabelType="FloatLabelType.Never"
                   @bind-Value="TestProcessesFilter!.FilterText"
                   Width="50%"
                   Input="OnInputChange">
        </SfTextBox>
    </div>

    <SfButton CssClass="e-warning e-icon-left e-medium ml-auto"
              Content="Sonuç Yazdır"
              IconCss="e-icons e-print"
              OnClick="OnPrintClick">
    </SfButton>
</div>

<SfGrid @ref="TestProcessesGrid" DataSource="@TestResultsList" AllowPaging="false" AllowSorting="true" Height="700px">
    <GridEvents TValue="TestProcessDto" RowDataBound="RowBound"></GridEvents>
    <GridColumns>
        <GridColumn Field=@nameof(TestProcessDto.ProtocolNo) Width="100%" HeaderText="Protokol No" TextAlign="TextAlign.Center"></GridColumn>
        <GridColumn HeaderText="Hasta Ad-Soyad" Width="100%" TextAlign="TextAlign.Center">
            <Template Context="context">
                @if (context is TestProcessDto testProcess)
                {
                    @($"{testProcess.PatientName} {testProcess.PatientSurname}")
                }
            </Template>
        </GridColumn>
        <GridColumn HeaderText="Doktor Ad-Soyad" Width="100%" TextAlign="TextAlign.Center">
            <Template Context="context">
                @if (context is TestProcessDto testProcess)
                {
                    @($"{testProcess.DoctorName} {testProcess.DoctorSurname}")
                }
            </Template>
        </GridColumn>    
        <GridColumn HeaderText="Test Adı" Width="100%" TextAlign="TextAlign.Center">
            <Template Context="context">
                @if (context is TestProcessDto testProcess)
                {
                    @($"{testProcess.TestGroupName} - {testProcess.TestGroupItemName}")
                }
            </Template>
        </GridColumn>
        <GridColumn HeaderText="Min-Max Değer" Width="100%" TextAlign="TextAlign.Center">
            <Template Context="context">
                @if (context is TestProcessDto testProcess)
                {
                    @($"{testProcess.TestMinValue} - {testProcess.TestMaxValue}")
                }
            </Template>
        </GridColumn>      
        <GridColumn Field=@nameof(TestProcessDto.Result) Width="100%" HeaderText="Değer" TextAlign="TextAlign.Center"></GridColumn>
        <GridColumn Field=@nameof(TestProcessDto.TestUnit) Width="100%" HeaderText="" TextAlign="TextAlign.Center"></GridColumn>
        <GridColumn Field=@nameof(TestProcessDto.ResultDate) HeaderText="Result Date" Width="100%" TextAlign="TextAlign.Center"></GridColumn>
    </GridColumns>
</SfGrid>

<style>
    .bg-success {
        background-color: #639833 !important;
    }

    .bg-danger {
        background-color: #A33B3B !important;
    }
</style>